<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Indicadores</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    h2 { margin-bottom: 10px; }
    input {
      padding: 10px;
      width: 350px;
      margin-bottom: 15px;
      font-size: 14px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      font-size: 12px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    th {
      background: #f2f2f2;
      position: sticky;
      top: 0;
    }
  </style>
</head>
<body>

<h2>Panel de Indicadores desde Google Sheets</h2>

<input type="text" id="filtro" placeholder="Buscar por representante, RAC, mes, mÃ©tricas, etc...">

<table id="tabla">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTv__z4dmUZOol3wAk_xfvxVHrJHFuaP3dKX8M9S-j6dd3WjUz0iCpxGnIOzpq2s1oOKPWGf5q45Yox/pub?output=csv";

fetch(url)
  .then(res => res.text())
  .then(data => {
    const filas = data.trim().split("\n").map(f => f.split(","));
    const encabezados = filas[0];
    const datos = filas.slice(1);

    const thead = document.querySelector("thead");
    const tbody = document.querySelector("tbody");

    // Encabezados
    thead.innerHTML = "<tr>" + encabezados.map(h => `<th>${h}</th>`).join("") + "</tr>";

    function render(filtrado) {
      tbody.innerHTML = "";
      filtrado.forEach(fila => {
        tbody.innerHTML += "<tr>" + fila.map(c => `<td>${c}</td>`).join("") + "</tr>";
      });
    }

    render(datos);

    // Buscador en todas las columnas
    document.getElementById("filtro").addEventListener("keyup", e => {
      const texto = e.target.value.toLowerCase();

      const resultado = datos.filter(fila =>
        fila.some(celda =>
          celda.toLowerCase().includes(texto)
        )
      );

      render(resultado);
    });
  });
</script>

</body>
</html>

